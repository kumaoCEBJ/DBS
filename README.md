# DBS
素人開発

## 開発環境
* VBSavior Ver2.01→2.04
* Windows10/Microsoft Edge/Blazor WebAssembly

## 履歴
* 2025/06/14 v1.02 ドラッグアンドドロップと無関係の画像のドラッグを抑制
* 2025/06/01 v1.01 師団詳細の表示用の活性/指揮の値が正しく表示されていなかった他
* 2025/05/31 v1.00

## 操作
* 左クリック : 決定、表示の切り替え、ドラッグアンドドロップ(以下D&D)
  * 表示の切り替え
    * 称号一覧のスキル/ステータス
    * 師団詳細のターゲット一覧のHP値/HP割合
    * 師団拡張のスタンス、アライメント/内政、アシストスキル
  * D&Dの対象 : ユニット、師団、称号、装備、戦術効果、検索結果、シミュ結果、シミュ設定
    * 師団のD&Dは師団一覧の師団番号が対象
* 右クリック : 解除、削除
  * 師団番号を右クリックで師団解散

## 機能
* 出力 : クリップボードに指定した師団情報をコピー
* 検索
  * ユニット名検索 : 一文字でも一致していたら該当
  * スキル検索 : スキルの値の高い順にソート
  * 戦術スキル検索
    * 選択した効果が一つの場合はその効果でソート
    * 二つ選択している場合は検索条件1でソート
* シミュ : [後述](#シミュの説明)
* 称号一覧
* 装備一覧 : 装備の詳細欄をクリックすると装備済みのユニットを検索
* ユニット一覧
  * 表示上部 : ユニット一覧
  * 表示下部 : 編成済みのユニット一覧
* 師団詳細 : [後述](#師団詳細の説明)
* 検索結果
* シミュ結果
* BAN設定
  * 設定後の｢更新｣で対象が非表示
  * 編成済みの師団一覧も対象
* オプション : [後述](#オプションの説明)

## `不具合を認識しているが修正出来ないもの`
* D&D関連
  * ドロップ可能かどうかを表示する設定が常に許可状態
    * ドロップ時に判定をしているので解決扱い
* 特定の動作で文字の色がにじむ
  * 原因不明  
* 師団詳細の計算の誤差
  * 実際のゲームの計算式と違う他色々
* 一部一般ユニットの解放条件(BAN設定)が実際のゲームと違う
  * 雇用時のタリスマンのみで判定
* 師団詳細の所持スキル一覧の竜歌共鳴にスキルの値がない
  * 表示枠の問題と個別のスキルの値は重要ではないので非表示
* シミュ実行中のメッセージ表示が不安定
  * 処理速度の関係

## その他
* ゲーム内の説明と効果が不一致だったものを実際の効果に合わせたものに変更
  * イザヨイ、覚醒イザヨイの称号｢這い寄る変態｣の特攻 : 人人→人
  * 英雄覇気 : 師団指揮＋師団支配→師団活性＋師団指揮＋師団支配
  * 〇〇転化 : 師団員の〇〇に加算する→〇〇値にボーナス
    * スキル所持者にも効果があったので〇〇布陣の説明の一部を使用
* フィルターの特攻 : 無はユニットのみ適用
* 倍率のクリティカル計算はユニットの速度を除外
* 師団詳細の所持スキル一覧の平等治癒は平等治癒+グルメ魂
* BAN設定で武将称号のみの一括処理が出来ない
  * 他の機能との両立が上手くいかなかったので削除
  * ｢修羅に至る闘争｣を有効にするとデウス報酬ユニットの称号はBAN

## 師団詳細の説明
選択師団の所持スキルと簡易的なステータス等を表示します。
* ｢計算｣ : 戦闘開始直後を想定したステータスとターゲットを算出します。
* ｢切替｣ : 適用された師団活性枠/師団指揮枠の値と全パターンのターゲットを表示します。
  * 計算結果のステータスは実際のゲームとの誤差が発生します。
  * 開発中に誤差3まで確認しています。4以上の場合は設定を確認して下さい。
  * 複雑な状況の場合は実装した処理が誤っている可能性があります。
  * ｢計算｣に使用される師団のアシストスキルは｢師団活性/師団指揮/バリアー/兵士運搬/地形無効｣です。
* ユニットアイコン下の｢レ/武/弱｣はレベル/武功/弱体値で個別に適用するために使用します。
  * 弱体値はステータス別の指定は出来ません。
  * 有効/無効は入力欄横のチェックボックスで切り替えます。無効の時は右側の一括用の値を使用します。
  * 一括用の｢師団弱体/軍団活性/軍団指揮/活性師団/活性指揮｣には他の師団の値を入力して下さい。
  * レベルは入力された値が各ユニットの上限を超える場合は上限の値に指定されます。
  * 忠誠は報酬計算に使用されます。個別の適用は出来ません。
* ｢計算｣後に縦に並ぶユニットアイコンの中で一番上のアイコンが想定されるターゲットです。
  * アイコン下の数値はターゲットが切り替わるHPです。
  * 囮HPはHP100%の状態でターゲットとされるユニットのHPを指定した値に変更します。
* ボーナスは0〜100の値でそのセーブデータで得た経験値から算出されます。
  * 推測するのは難しいのでゲーム内で直接確認して下さい。
  * ボーナスは各スタンスのステータス上昇に追加されます。
    * 進撃スタンス : 攻撃に3+ボーナス
    * 防備スタンス : 防御に5+ボーナス
    * 計略スタンス : 速度と知力に4+ボーナス
    * 乱戦スタンス : 全種に1+ボーナス/2
  * 確認方法は同じ戦闘でスタンスだけ変更してステータスの変動を見ます。進撃→防備が手軽です。
  * ボーナスのざっくり参考値(周回数とそのセーブデータのユニットの最高レベル)
    * 周回数1レベル57 : 43
    * 周回数2レベル113 : 97
    * 周回数3レベル145 : 100

## シミュの説明
指定したスキルとフィルターの設定を使って候補を作り、総当たりする処理です。
* 処理の結果が膨大な数になりやすいので出来るだけ条件を指定して下さい。
  * 具体的にはスキルの下限を設定すると効果が大きいです。
* オプションで追加設定が可能です。
* 通常シミュと詳細シミュがあります。詳細シミュは通常シミュで作った候補の中から選択して実行します。
  * 加護と特攻をフィルターに指定した場合、ユニットは無条件で候補に選出されます。
  * 称号や装備の簡易的なBAN機能があり、そのシミュでは候補に選出されません。
    * BAN設定とは異なり、称号を指定してもユニットは選出されます。
  * シミュ結果一覧はスキル設定の1〜3番目のスキルの値の高い順でソートしています。
    * スキルの値が固定のものは4番目以降に指定して下さい。
  * ｢撃破金運/グルメ魂｣のみ重複指定が可能です。
* ｢トレハン師団｣はおまけ機能です。総当たりではないので最高値ではない可能性があります。
  * 糧食を完全に除外しています。｢トレハン｣以外のスキルを設定しても糧食は候補に選出されません。
  * ｢専守防衛/遠隔攻撃/次元斬撃｣を有効にした場合、リーダーと称号の設定は無効になります。

## オプションの説明
* ｢前回の設定を読み込む｣を有効にすると師団一覧/BAN設定/オプションを保存して次回起動時に読み込みます。
* 倍率/減算は特定のスキルのみを使用した簡易的な計算処理です。
  * 使用しているスキルは下記の通りです。
    * ｢致命必殺/必殺増加/カブト割/次元斬撃/多段攻撃/全力攻撃/心核穿ち/巨人狩り/無効喰い/乾坤一擲/確率追撃/加速進化/集約攻撃/範囲攻撃｣
* ｢シミュ結果に倍率を反映する｣を有効にするとシミュ結果一覧を倍率→1番目のスキル→2番目→3番目の順でソートします。
* ｢キャンセル命令〜候補数｣はシミュ結果の候補数が指定した値を超えた場合に処理を中止します。
  * ｢トレハン師団｣の場合は師団数が指定した値/10の値を超えた場合に処理を中止します。
* ｢キャンセル命令〜経過時間｣は実行時から指定した時間を超えた場合に処理を中止しますが挙動が不安定です。

## 今後
* やる : 出来る範囲の不具合修正
* やるかも : テキストを使った師団入力機能の追加
* やらない : ダメージ計算等の正確な計算が必要な機能の追加